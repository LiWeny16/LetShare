import{r as f}from"./react-B4V_vTrs.js";import{c as Q}from"./html-parse-stringify-DSrHXhB7.js";const P=(e,t,n,r)=>{const o=[n,{code:t,...r||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(o,"warn","react-i18next::",!0);S(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...o):console?.warn&&console.warn(...o)},z={},L=(e,t,n,r)=>{S(n)&&z[n]||(S(n)&&(z[n]=new Date),P(e,t,n,r))},M=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},R=(e,t,n)=>{e.loadNamespaces(t,M(e,n))},B=(e,t,n,r)=>{if(S(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return R(e,n,r);n.forEach(o=>{e.options.ns.indexOf(o)<0&&e.options.ns.push(o)}),e.loadLanguages(t,M(e,r))},Z=(e,t,n={})=>!t.languages||!t.languages.length?(L(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:n.lng,precheck:(r,o)=>{if(n.bindI18n?.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!o(r.isLanguageChangingTo,e))return!1}}),S=e=>typeof e=="string",k=e=>typeof e=="object"&&e!==null,ee=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,te={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},ne=e=>te[e],se=e=>e.replace(ee,ne);let H={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:se};const re=(e={})=>{H={...H,...e}},U=()=>H;let W;const ae=e=>{W=e},D=()=>W,_=(e,t)=>{if(!e)return!1;const n=e.props?.children??e.children;return t?n.length>0:!!n},F=e=>{if(!e)return[];const t=e.props?.children??e.children;return e.props?.i18nIsDynamicList?j(t):t},oe=e=>Array.isArray(e)&&e.every(f.isValidElement),j=e=>Array.isArray(e)?e:[e],ie=(e,t)=>{const n={...t};return n.props=Object.assign(e.props,t.props),n},G=(e,t,n,r)=>{if(!e)return"";let o="";const a=j(e),h=t?.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return a.forEach((N,x)=>{if(S(N)){o+=`${N}`;return}if(f.isValidElement(N)){const{props:u,type:g}=N,E=Object.keys(u).length,A=h.indexOf(g)>-1,T=u.children;if(!T&&A&&!E){o+=`<${g}/>`;return}if(!T&&(!A||E)||u.i18nIsDynamicList){o+=`<${x}></${x}>`;return}if(A&&E===1&&S(T)){o+=`<${g}>${T}</${g}>`;return}const p=G(T,t,n,r);o+=`<${x}>${p}</${x}>`;return}if(N===null){P(n,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:r});return}if(k(N)){const{format:u,...g}=N,E=Object.keys(g);if(E.length===1){const A=u?`${E[0]}, ${u}`:E[0];o+=`{{${A}}}`;return}P(n,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:r,child:N});return}P(n,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:r,child:N})}),o},ce=(e,t,n,r,o,a)=>{if(t==="")return[];const h=r.transKeepBasicHtmlNodesFor||[],N=t&&new RegExp(h.map(c=>`<${c}`).join("|")).test(t);if(!e&&!N&&!a)return[t];const x={},u=c=>{j(c).forEach(i=>{S(i)||(_(i)?u(F(i)):k(i)&&!f.isValidElement(i)&&Object.assign(x,i))})};u(e);const g=Q.parse(`<0>${t}</0>`),E={...x,...o},A=(c,b,i)=>{const d=F(c),m=p(d,b.children,i);return oe(d)&&m.length===0||c.props?.i18nIsDynamicList?d:m},T=(c,b,i,d,m)=>{c.dummy?(c.children=b,i.push(f.cloneElement(c,{key:d},m?void 0:b))):i.push(...f.Children.map([c],l=>{const s={...l.props};return delete s.i18nIsDynamicList,f.createElement(l.type,{...s,key:d,ref:l.ref},m?null:b)}))},p=(c,b,i)=>{const d=j(c);return j(b).reduce((l,s,y)=>{const O=s.children?.[0]?.content&&n.services.interpolator.interpolate(s.children[0].content,E,n.language);if(s.type==="tag"){let w=d[parseInt(s.name,10)];i.length===1&&!w&&(w=i[0][s.name]),w||(w={});const C=Object.keys(s.attrs).length!==0?ie({props:s.attrs},w):w,v=f.isValidElement(C),V=v&&_(s,!0)&&!s.voidElement,Y=N&&k(C)&&C.dummy&&!v,K=k(e)&&Object.hasOwnProperty.call(e,s.name);if(S(C)){const $=n.services.interpolator.interpolate(C,E,n.language);l.push($)}else if(_(C)||V){const $=A(C,s,i);T(C,$,l,y)}else if(Y){const $=p(d,s.children,i);T(C,$,l,y)}else if(Number.isNaN(parseFloat(s.name)))if(K){const $=A(C,s,i);T(C,$,l,y,s.voidElement)}else if(r.transSupportBasicHtmlNodes&&h.indexOf(s.name)>-1)if(s.voidElement)l.push(f.createElement(s.name,{key:`${s.name}-${y}`}));else{const $=p(d,s.children,i);l.push(f.createElement(s.name,{key:`${s.name}-${y}`},$))}else if(s.voidElement)l.push(`<${s.name} />`);else{const $=p(d,s.children,i);l.push(`<${s.name}>${$}</${s.name}>`)}else if(k(C)&&!v){const $=s.children[0]?O:null;$&&l.push($)}else T(C,O,l,y,s.children.length!==1||!O)}else if(s.type==="text"){const w=r.transWrapTextNodes,C=a?r.unescape(n.services.interpolator.interpolate(s.content,E,n.language)):n.services.interpolator.interpolate(s.content,E,n.language);w?l.push(f.createElement(w,{key:`${s.name}-${y}`},C)):l.push(C)}return l},[])},I=p([{dummy:!0,children:e||[]}],g,j(e||[]));return F(I[0])},J=(e,t,n)=>{const r=e.key||t,o=f.cloneElement(e,{key:r});if(!o.props||!o.props.children||n.indexOf(`${t}/>`)<0&&n.indexOf(`${t} />`)<0)return o;function a(){return f.createElement(f.Fragment,null,o)}return f.createElement(a,{key:r})},le=(e,t)=>e.map((n,r)=>J(n,r,t)),ue=(e,t)=>{const n={};return Object.keys(e).forEach(r=>{Object.assign(n,{[r]:J(e[r],r,t)})}),n},pe=(e,t,n,r)=>e?Array.isArray(e)?le(e,t):k(e)?ue(e,t):(L(n,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:r}),null):null;function fe({children:e,count:t,parent:n,i18nKey:r,context:o,tOptions:a={},values:h,defaults:N,components:x,ns:u,i18n:g,t:E,shouldUnescape:A,...T}){const p=g||D();if(!p)return L(p,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:r}),e;const I=E||p.t.bind(p)||(V=>V),c={...U(),...p.options?.react};let b=u||I.ns||p.options?.defaultNS;b=S(b)?[b]:b||["translation"];const i=G(e,c,p,r),d=N||i||c.transEmptyNodeValue||r,{hashTransKey:m}=c,l=r||(m?m(i||d):i||d);p.options?.interpolation?.defaultVariables&&(h=h&&Object.keys(h).length>0?{...h,...p.options.interpolation.defaultVariables}:{...p.options.interpolation.defaultVariables});const s=h||t!==void 0&&!p.options?.interpolation?.alwaysFormat||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},y={...a,context:o||a.context,count:t,...h,...s,defaultValue:d,ns:b},O=l?I(l,y):d,w=pe(x,O,p,r),C=ce(w||e,O,p,c,y,A),v=n??c.defaultTransParent;return v?f.createElement(v,T,C):C}const Ne={type:"3rdParty",init(e){re(e.options.react),ae(e)}},X=f.createContext();class de{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}function Ee({children:e,count:t,parent:n,i18nKey:r,context:o,tOptions:a={},values:h,defaults:N,components:x,ns:u,i18n:g,t:E,shouldUnescape:A,...T}){const{i18n:p,defaultNS:I}=f.useContext(X)||{},c=g||p||D(),b=E||c?.t.bind(c);return fe({children:e,count:t,parent:n,i18nKey:r,context:o,tOptions:a,values:h,defaults:N,components:x,ns:u||b?.ns||I||c?.options?.defaultNS,i18n:c,t:E,shouldUnescape:A,...T})}const ge=(e,t)=>{const n=f.useRef();return f.useEffect(()=>{n.current=e},[e,t]),n.current},q=(e,t,n,r)=>e.getFixedT(t,n,r),me=(e,t,n,r)=>f.useCallback(q(e,t,n,r),[e,t,n,r]),Te=(e,t={})=>{const{i18n:n}=t,{i18n:r,defaultNS:o}=f.useContext(X)||{},a=n||r||D();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new de),!a){L(a,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const m=(s,y)=>S(y)?y:k(y)&&S(y.defaultValue)?y.defaultValue:Array.isArray(s)?s[s.length-1]:s,l=[m,{},!1];return l.t=m,l.i18n={},l.ready=!1,l}a.options.react?.wait&&L(a,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const h={...U(),...a.options.react,...t},{useSuspense:N,keyPrefix:x}=h;let u=o||a.options?.defaultNS;u=S(u)?[u]:u||["translation"],a.reportNamespaces.addUsedNamespaces?.(u);const g=(a.isInitialized||a.initializedStoreOnce)&&u.every(m=>Z(m,a,h)),E=me(a,t.lng||null,h.nsMode==="fallback"?u:u[0],x),A=()=>E,T=()=>q(a,t.lng||null,h.nsMode==="fallback"?u:u[0],x),[p,I]=f.useState(A);let c=u.join();t.lng&&(c=`${t.lng}${c}`);const b=ge(c),i=f.useRef(!0);f.useEffect(()=>{const{bindI18n:m,bindI18nStore:l}=h;i.current=!0,!g&&!N&&(t.lng?B(a,t.lng,u,()=>{i.current&&I(T)}):R(a,u,()=>{i.current&&I(T)})),g&&b&&b!==c&&i.current&&I(T);const s=()=>{i.current&&I(T)};return m&&a?.on(m,s),l&&a?.store.on(l,s),()=>{i.current=!1,a&&m?.split(" ").forEach(y=>a.off(y,s)),l&&a&&l.split(" ").forEach(y=>a.store.off(y,s))}},[a,c]),f.useEffect(()=>{i.current&&g&&I(A)},[a,x,g]);const d=[p,a,g];if(d.t=p,d.i18n=a,d.ready=g,g||!g&&!N)return d;throw new Promise(m=>{t.lng?B(a,t.lng,u,()=>m()):R(a,u,()=>m())})};export{Ee as T,Ne as i,Te as u};
