import{r as u,j as n,a as N}from"./react-B4V_vTrs.js";import{R as Ue,c as Ee}from"./react-dom-CqEOeDN_.js";import{S as Pe,A as ze,B as p,T as A,I as ee,d as Me,a as Le,D as K,b as de,c as Z,e as V,F as q,C as Y,u as Ne,f as ue,g as Je,L as te,h as E,i as ne,j as Ve,M as Be,k as Oe,P as We,l as He,m as Qe,n as Ke,o as Ze,p as qe,q as O,r as Ye,s as Re,t as Ge,v as Xe,w as $e,x as _e,y as et,z as tt,E as nt,G as se,H as re,J as st,K as rt,N as it,O as ie}from"./@mui-1rh4ksr5.js";import{k as he}from"./bigonion-kit-CY3QLVqN.js";import{m as at}from"./mitt-DJ65BbbF.js";import{i as ae,o as oe}from"./react-device-detect-Bibxsb49.js";import{Q as ge}from"./react-qrcode-logo-BeSdvrP5.js";import{J as ot}from"./jszip-GG0MNtfG.js";import{H as ct}from"./react-router-dom-BTLnAETc.js";import{a as lt,b as ce}from"./react-router-eewwE4pT.js";import"./@babel-LAXhhp6N.js";import"./scheduler-CzFDRTuY.js";import"./clsx-B-dksMZM.js";import"./react-is-DUDD-a5e.js";import"./@emotion-Dtuj-UBK.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-DW3lCxvG.js";import"./react-transition-group-CSnmlvJK.js";import"./ua-parser-js-4RjAY7Bl.js";import"./lodash.isequal-CFHbgcyd.js";import"./qrcode-generator-B7rwAJ2l.js";import"./@remix-run-DspApiwr.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const pe=at(),dt=()=>{const[o,e]=u.useState(!1),[t,r]=u.useState(""),[s,i]=u.useState("success"),[c,d]=u.useState(2500),[l,f]=u.useState(9999);return u.useEffect(()=>{pe.on("show",g=>{r(g.message),i(g.severity||"success"),d(g.duration||2500),f(g.zIndex||9999),e(!0)})},[]),Ue.createPortal(n.jsx(Pe,{open:o,autoHideDuration:c,onClose:()=>{e(!1)},anchorOrigin:{vertical:"top",horizontal:"center"},style:{zIndex:l},children:n.jsx(ze,{onClose:()=>e(!1),severity:s,variant:"filled",children:t})}),document.body)},I=(o,e,t)=>{pe.emit("show",{message:o,severity:t?.kind??"success",duration:e??2500,zIndex:t?.zIndex??9999})};class ut{rtc;rtcServers=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun.counterpath.net"},{urls:"stun:stun.internetcalls.com"},{urls:"stun:stun.voip.aebc.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.xten.com"},{urls:"stun:global.stun.twilio.com:3478"}];constructor(e){this.rtc=e}createPeerConnection(e){const t=new RTCPeerConnection({iceServers:this.rtcServers,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});this.rtc.negotiationMap.set(e,{isNegotiating:!1,queue:[]}),t.onnegotiationneeded=async()=>{};let r=[],s=!1;return t.onicecandidate=i=>{if(i.candidate){r.push(i.candidate);const l=i.candidate.candidate.split(" "),f=l[4];l[7]==="host"&&this.isPrivateIP(f),s||(s=!0,setTimeout(()=>{this.rtc.broadcastSignal({type:"candidate",candidates:r,to:e}),r=[],s=!1},400))}},t.ondatachannel=i=>{this.rtc.setupDataChannel(i.channel,e)},t.oniceconnectionstatechange=()=>{if(console.log(`[CONNECT] ${e} ICE Áä∂ÊÄÅ:`,t.iceConnectionState),t.iceConnectionState==="connected"){console.log(`[CONNECT] ‚úÖ ${e} ËøûÊé•ÊàêÂäüÔºåÂèñÊ∂àË∂ÖÊó∂`);const i=this.rtc.userList.get(e);i&&this.rtc.userList.set(e,{...i,status:"connected"}),clearTimeout(this.rtc.connectionTimeouts.get(e))}(t.iceConnectionState==="failed"||t.iceConnectionState==="disconnected")&&(console.warn(`[CONNECT] ‚ùå ${e} ICE ËøûÊé•Â§±Ë¥•ÔºåÁ´ãÂç≥ÂÖ≥Èó≠`),t.close(),m.peers.delete(e),this.rtc.updateConnectedUsers(this.rtc.userList))},e&&m.peers.set(e,t),t}removePeer(e){const t=m.peers.get(e);t&&(t.close(),m.peers.delete(e)),this.rtc.dataChannels.delete(e),this.rtc.negotiationMap.delete(e),this.rtc.lastConnectAttempt.delete(e),this.rtc.userList.delete(e),console.log(`üßπ Â∑≤Ê∏ÖÈô§‰∏é ${e} ÁöÑËøûÊé•ËµÑÊ∫ê`)}isPrivateIP(e){return e.startsWith("10.")||e.startsWith("192.168.")||e.match(/^172\.(1[6-9]|2\d|3[0-1])\./)}}const H=()=>ae&&oe==="iOS"?"apple":ae&&oe==="Android"?"android":"desktop";class m{static instance=null;static userId=null;static uniqId=null;static peers=new Map;aborted=!1;dataChannels=new Map;ws=null;userList=new Map;setMsgFromSharing=()=>{};setFileTransferProgress=()=>{};setDownloadPageState=()=>{};updateConnectedUsers=()=>{};fileMetaInfo={name:"default_received_file"};lastPongTimes=new Map;lastPingTimes=new Map;isSendingFile=!1;heartbeatIntervals=new Map;timeoutHandles=new Set;receivingFiles=new Map;receivedFiles=new Map;coolingTime=3e3;connectionQueue=new Map;pendingOffers=new Set;negotiationMap=new Map;pingFailures=new Map;pongFailures=new Map;cleaningLock=!1;peerManager;lastConnectAttempt=new Map;connectionTimeouts=new Map;recentlyResetPeers=new Map;setFileSendingTargetUser=()=>{};transferConfig={chunkSize:32*1024,maxConcurrentReads:10,bufferThreshold:256*1024};initTransferConfig(){const e=H();e==="apple"||e==="android"?this.transferConfig={chunkSize:4*32*1024,maxConcurrentReads:8,bufferThreshold:128*1024}:this.transferConfig={chunkSize:32*1024,maxConcurrentReads:8,bufferThreshold:256*1024}}async init(e,t,r,s=()=>{},i){this.setFileSendingTargetUser=e,this.setMsgFromSharing=t,this.setDownloadPageState=r,this.updateConnectedUsers=s,this.setFileTransferProgress=i,this.initTransferConfig(),he.sleep(this.coolingTime),setInterval(async()=>{for(const[c,d]of this.userList.entries())if(d.status==="waiting"){if(d.attempts>=3){console.warn(`[USER CHECK] ${c} ÈáçËØïÊ¨°Êï∞ËøáÂ§öÔºåÊ†áËÆ∞‰∏∫ disconnected`),d.status="disconnected",this.userList.set(c,d),this.updateConnectedUsers(this.userList);continue}try{await this.connectToUser(c),d.status="connecting",d.attempts+=1,this.userList.set(c,d)}catch(l){console.error(`[USER CHECK] ËøûÊé• ${c} Â§±Ë¥•:`,l)}}},5e3)}constructor(){const e=this.getStatesMemorable();let t=e.memorable.userId,r=e.memorable.uniqId;this.peerManager=new ut(this),t||(t=this.generateUUID(),this.changeStatesMemorable({memorable:{userId:t}})),r||(r=`${t}:${this.generateUUID()}`,this.changeStatesMemorable({memorable:{uniqId:r}})),m.userId=t,m.uniqId=r}compareUniqIdPriority(e,t){const[r,s]=e.split(":"),[i,c]=t.split(":");if(!s||!c)return!1;const d=s.localeCompare(c);if(d>0)return!0;if(d<0)return!1;const l=r.localeCompare(i);return l>0?!0:l<0?!1:e>t}getStatesMemorable(){const e=localStorage.getItem("memorableState");if(!e)return{memorable:{userId:null,uniqId:null}};try{const t=JSON.parse(e);return{memorable:{userId:t.memorable?.userId??null,uniqId:t.memorable?.uniqId??null}}}catch{return console.warn("üßπ Ëß£Êûê localStorage Â§±Ë¥•ÔºåÊ∏ÖÁêÜÁä∂ÊÄÅ"),localStorage.removeItem("memorableState"),{memorable:{userId:null,uniqId:null}}}}changeStatesMemorable(e){const t=this.getStatesMemorable().memorable,r={userId:e.memorable.userId??t.userId,uniqId:e.memorable.uniqId??t.uniqId};localStorage.setItem("memorableState",JSON.stringify({memorable:r}))}getUniqId(){return m.uniqId}getUserId(){return m.userId}setUserId(e){if(m.userId!=e){m.userId=e,this.changeStatesMemorable({memorable:{userId:e}});const t=`${e}:${this.generateUUID()}`;m.uniqId=t,this.changeStatesMemorable({memorable:{uniqId:t}})}}setUniqId(e){m.uniqId=e,this.changeStatesMemorable({memorable:{uniqId:e}})}static getInstance(){return m.instance||(m.instance=new m),m.instance}async connect(e){try{this.ws=new WebSocket(e),this.ws.onopen=async()=>{await this.waitForUnlock(this.cleaningLock),setTimeout(()=>{this.broadcastSignal({type:"discover",userType:H()})},2500)},this.ws.onmessage=t=>this.handleSignal(t),this.ws.onclose=()=>this.cleanUpConnections(),this.ws.onerror=t=>console.error("WebSocket error:",t),window.addEventListener("beforeunload",()=>{}),window.addEventListener("pagehide",()=>{})}catch(t){console.log(t)}}async disconnect(e){e&&e(null),this.cleanUpConnections()}cleanUpConnections(){console.warn("üîå WebSocket disconnected, cleaning up only WS-related state."),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}async handleSignal(e){try{const t=JSON.parse(e.data);if(!t)return;switch(t.type){case"discover":await this.handleDiscover(t);break;case"offer":await this.handleOffer(t);break;case"answer":await this.handleAnswer(t);break;case"candidate":await this.handleCandidate(t);break;case"leave":this.handleLeave(t);break;default:console.warn("Unknown message type",t.type)}}catch(t){console.error("üö® Failed to parse WebSocket message:",e.data,t)}}async handleDiscover(e){const t=e.from,r=e.isReply;if(!t||t===this.getUniqId())return;const s=Date.now(),i=this.userList.get(t);if(!i)this.userList.set(t,{status:"waiting",attempts:0,lastSeen:s,userType:e.userType});else if(i.lastSeen=s,i.status==="disconnected"&&(i.attempts=2,i.status="waiting"),i.status==="waiting"||i.status==="connecting"||i.status==="connected")return;if(r||this.broadcastSignal({type:"discover",to:t,isReply:!0,userType:H()}),this.compareUniqIdPriority(this.getUniqId(),t)){const c=this.userList.get(t);if(c.status==="waiting")try{await this.connectToUser(t),c.attempts=0}catch{console.warn("ÂèëÈÄÅÈîôËØØ"),c.attempts++,c.attempts>=10&&(c.status="disconnected")}else if(c.status==="connecting")return}this.updateConnectedUsers(this.userList)}async handleLeave(e){const t=e.id;if(this.cleaningLock){console.warn("‚õîÔ∏è ÂΩìÂâçÊ≠£Âú®Ê∏ÖÁêÜÂÖ∂‰ªñËøûÊé•ÔºåË∑≥ËøáÊú¨Ê¨° handleLeave");return}this.cleaningLock=!0;try{console.warn(`üì§ Ê≠£Âú®Ê∏ÖÁêÜÁî®Êà∑ ${t} ÁöÑÊâÄÊúâÁä∂ÊÄÅ`);const r=this.userList.get(t);r&&(r.status="disconnected",this.userList.set(t,r));const s=m.peers.get(t);s&&(s.close(),m.peers.delete(t));const i=this.dataChannels.get(t);i&&(i.close(),this.dataChannels.delete(t)),this.negotiationMap.delete(t),this.connectionQueue.delete(t),this.pendingOffers.delete(t),this.lastPongTimes.delete(t),this.lastPingTimes.delete?.(t),this.pingFailures.delete(t),this.pongFailures.delete(t),this.updateConnectedUsers(this.userList),await new Promise(c=>setTimeout(c,50))}finally{this.cleaningLock=!1}}broadcastSignal(e){if(this.ws&&this.ws.readyState===WebSocket.OPEN){const t={...e,from:this.getUniqId()};this.ws.send(JSON.stringify(t))}}async handleOffer(e){const t=e.from;m.peers.has(t)||this.peerManager.createPeerConnection(t),this.negotiationMap.get(t).queue.push({type:"offer",sdp:e.offer}),this.processNegotiationQueue(t)}async processNegotiationQueue(e){if(!m.peers.get(e))return;const r=this.negotiationMap.get(e);if(r&&!r.isNegotiating){r.isNegotiating=!0;try{for(;r.queue.length>0;){const s=r.queue.shift();s.type==="offer"?await this.doHandleOffer(e,s.sdp):s.type==="answer"&&await this.doHandleAnswer(e,s.sdp)}}finally{r.isNegotiating=!1}}}async doHandleOffer(e,t){const r=m.peers.get(e);if(!r)return;const s=this.getUniqId()>e;if(r.signalingState==="have-local-offer"||r.signalingState==="have-local-pranswer")if(s){const d=Date.now(),l=this.recentlyResetPeers.get(e)??0;if(d-l<5e3){console.warn(`[OFFER] ÊúÄËøëÂàö reset Ëøá ${e}ÔºåË∑≥Ëøá`);return}console.warn(`[OFFER] Polite peer, resetting connection with ${e}`),this.recentlyResetPeers.set(e,d),r.close(),m.peers.delete(e);const f=this.peerManager.createPeerConnection(e);m.peers.set(e,f);const g=this.negotiationMap.get(e);g&&(g.queue.unshift({type:"offer",sdp:t}),this.processNegotiationQueue(e));return}else{console.warn("[OFFER] Impolite peer, ignoring incoming offer");return}await r.setRemoteDescription(new RTCSessionDescription(t));const c=await r.createAnswer();await r.setLocalDescription(c),this.broadcastSignal({type:"answer",answer:r.localDescription,to:e})}async handleAnswer(e){const t=e.from;if(!m.peers.has(t))return;const r=this.negotiationMap.get(t);r&&(r.queue.push({type:"answer",sdp:e.answer}),this.processNegotiationQueue(t))}async doHandleAnswer(e,t){const r=m.peers.get(e);if(r){if(r.signalingState!=="have-local-offer"){console.warn(`Ignore answer from ${e}, because local signalingState=${r.signalingState}`);return}await r.setRemoteDescription(new RTCSessionDescription(t))}}async handleCandidate(e){const t=m.peers.get(e.from);if(!t||!t.remoteDescription){console.warn("[ICE] ‚ùå Ë∑≥Ëøá ICEÔºåÂõ† remoteDescription Â∞öÊú™ËÆæÁΩÆ");return}if(t&&e.candidates)for(const r of e.candidates)try{await t.addIceCandidate(new RTCIceCandidate(r))}catch(s){console.error("Error adding ICE candidate:",s)}}getAllUsers(){return Array.from(this.userList.keys())}setupDataChannel(e,t){e.binaryType="arraybuffer",this.dataChannels.set(t,e),e.onopen=()=>{const r=this.connectionTimeouts.get(t);r&&(clearTimeout(r),this.connectionTimeouts.delete(t));const s=this.userList.get(t);s&&(s.status="connected",this.userList.set(t,s)),I("Êñ∞Áî®Êà∑Â∑≤ËøûÊé•: "+t.split(":")[0],2e3,{kind:"success"}),this.updateConnectedUsers(this.userList),this.heartbeatIntervals.has(t)&&(clearInterval(this.heartbeatIntervals.get(t)),this.heartbeatIntervals.delete(t));const i=setInterval(()=>{e.readyState==="open"&&e.send(JSON.stringify({type:"ping"}))},3e3);this.heartbeatIntervals.set(t,i)},this.receivingFiles||(this.receivingFiles=new Map),e.onmessage=r=>{if(typeof r.data=="string"){const s=JSON.parse(r.data);switch(s.type){case"file-meta":this.receivingFiles.set(t,{name:s.name,size:s.size,totalChunks:Math.ceil(s.size/s.chunkSize),chunks:new Array(Math.ceil(s.size/s.chunkSize)),chunkSize:s.chunkSize,receivedSize:0,receivedChunkCount:0}),C.fileMetaInfo.name=s.name,this.setDownloadPageState(!0);break;case"abort":C.abortFileTransferToUser?.(),this.setFileTransferProgress(null),this.setDownloadPageState(!1),I("ÂØπÊñπÂèñÊ∂à‰∫Ü‰º†ËæìÔºÅ",2e3,{kind:"error"});break;case"ping":this.lastPingTimes.set(t,Date.now()),this.pongFailures.set(t,0),e.readyState==="open"&&e.send(JSON.stringify({type:"pong"}));break;case"pong":this.lastPongTimes.set(t,Date.now());const i=this.userList.get(t);i&&(i.status="connected",this.userList.set(t,i)),this.pingFailures.set(t,0),this.updateConnectedUsers(this.userList);break;case"text":default:this.setMsgFromSharing(s.msg);break}}else{const s=r.data,i=8;if(s.byteLength<i){console.error("Êé•Êî∂Âà∞ÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆÂ§™Â∞è");return}const c=new DataView(s),d=c.getUint32(0),l=c.getUint32(4),f=s.slice(i);if(f.byteLength!==l){console.error(`ÂàáÁâá ${d} ÈïøÂ∫¶‰∏çÂåπÈÖçÔºöÂ∫î‰∏∫ ${l}ÔºåÂÆûÈôÖ‰∏∫ ${f.byteLength}`);return}const g=this.receivingFiles.get(t);if(!g){console.error("Â∞öÊú™Êî∂Âà∞Êñá‰ª∂ÂÖÉÊï∞ÊçÆÔºåÊó†Ê≥ïÂ§ÑÁêÜÂàáÁâá");return}if(g.chunks[d]||(g.chunks[d]=f,g.receivedSize+=f.byteLength,g.receivedChunkCount++),g.receivedChunkCount===g.totalChunks){const x=[];for(let h=0;h<g.totalChunks;h++){if(!g.chunks[h]){I(`Êñá‰ª∂‰º†ËæìÁº∫Â∞ëÂàáÁâá ${h}ÔºåËØ∑ÈáçÊñ∞‰º†ËæìÔºÅ`,1e3,{kind:"error"}),console.error(`Áº∫Â∞ëÂàáÁâá ${h}`),this.receivingFiles.delete(t);return}x.push(g.chunks[h])}const D=new Blob(x),b=new File([D],g.name,{type:"application/octet-stream"});this.receivedFiles.set(t+"::"+b.name,b),this.receivingFiles.delete(t),I("ÊàêÂäüÊé•ÂèóÊù•Ëá™"+t.split(":")[0]+"ÁöÑÊñá‰ª∂ÔºÅ")}}},e.onclose=()=>{console.log(`Data channel with user ${t} is closed`),this.heartbeatIntervals.has(t)&&(clearInterval(this.heartbeatIntervals.get(t)),this.heartbeatIntervals.delete(t)),this.userList.get(t)?.status==="connected"&&I("‰∏éÂØπÊñπÊñ≠ÂºÄËøûÊé•,ËØ∑Âà∑Êñ∞È°µÈù¢",2e3,{kind:"error"}),this.userList.delete(t),this.dataChannels.delete(t),this.updateConnectedUsers(this.userList),this.lastPongTimes.delete(t)},e.onerror=()=>{this.cleanupDataChannel(t)}}cleanupDataChannel(e){const t=this.dataChannels.get(e);t&&(t.close(),this.heartbeatIntervals.has(e)&&(clearInterval(this.heartbeatIntervals.get(e)),this.heartbeatIntervals.delete(e)),this.dataChannels.delete(e),this.userList.delete(e),this.lastPongTimes.delete(e),this.updateConnectedUsers(this.userList))}async connectToUser(e){const t=Date.now(),r=this.lastConnectAttempt.get(e)??0;if(t-r<4e3){console.warn(`[CONNECT] ‰∏é ${e} ÁöÑËøûÊé•Â∞ùËØïÂ§™È¢ëÁπÅÔºåË∑≥Ëøá`);return}if(this.lastConnectAttempt.set(e,t),this.connectionQueue.has(e)){console.warn(`[CONNECT] ${e} Ê≠£Âú®ËøûÊé•‰∏≠ÔºåË∑≥Ëøá`);return}this.connectionQueue.set(e,!0);try{let s=m.peers.get(e);if(s){const l=s.connectionState,f=this.dataChannels.get(e),g=["connected","connecting"].includes(l),x=f?.readyState==="open";if(g&&x){console.log(`[CONNECT] ${e} ËøûÊé•Ê≠£Â∏∏ (ICE: ${l}, Channel: open)`);return}console.warn(`[CONNECT] Ê∏ÖÁêÜ ${e} ÁöÑÊóßËøûÊé•`,`ICE Áä∂ÊÄÅ: ${l}, ÈÄöÈÅìÁä∂ÊÄÅ: ${f?.readyState||"missing"}`),s.close(),m.peers.delete(e),this.cleanupDataChannel(e)}s=this.peerManager.createPeerConnection(e);const i=s.createDataChannel("chat");this.setupDataChannel(i,e);const c=await s.createOffer({iceRestart:!0});await s.setLocalDescription(c),console.log(`[CONNECT] ‚úÖ Âêë ${e} ÂèëÈÄÅ offer`),this.broadcastSignal({type:"offer",offer:s.localDescription,to:e});const d=window.setTimeout(()=>{const l=m.peers.get(e);if(this.userList.get(e)?.status!="connected"&&l&&l.iceConnectionState!=="connected"&&l.iceConnectionState!=="checking"){console.warn(`[CONNECT] ‚è∞ ${e} ËøûÊé•ÈïøÊó∂Èó¥Êú™Âª∫Á´ãÔºåÂº∫Âà∂ÂÖ≥Èó≠`),l.close();const f=this.userList.get(e);f&&this.userList.set(e,{...f,status:"disconnected"}),m.peers.delete(e),this.cleanupDataChannel(e)}else console.log(`[CONNECT] ${e} Ê≠£Âú®ËøûÊé•‰∏≠ÔºåÂª∂ÈïøÁ≠âÂæÖ Áä∂ÊÄÅ`);this.connectionTimeouts.delete(e)},8e3);this.connectionTimeouts.set(e,d)}catch(s){console.error(`[CONNECT] ‚ùå ËøûÊé• ${e} Â§±Ë¥•:`,s)}finally{this.connectionQueue.delete(e),this.pendingOffers.delete(e)}}async sendMessageToUser(e,t){const r=this.dataChannels.get(e);if(r?.readyState==="open"){r.send(JSON.stringify({msg:t,type:"text"}));return}console.warn(`Channel not open with user ${e}. Attempting reconnection...`)}abortFileTransferToUser(){if(this.aborted=!0,this.isSendingFile=!1,this.timeoutHandles){for(const e of this.timeoutHandles)clearTimeout(e);this.timeoutHandles.clear()}}isConnectedToUser(e){const t=this.dataChannels.get(e);return!!t&&t.readyState==="open"}async sendFileToUser(e,t){const r=this.dataChannels.get(e);if(this.setFileSendingTargetUser(e),!r||r.readyState!=="open"){console.error(`Data channel with user ${e} is not available.`);return}const s=Math.ceil(t.size/this.transferConfig.chunkSize);let i=this.transferConfig.maxConcurrentReads,c=0,d=0;this.aborted=!1;const l=[],f={type:"file-meta",name:t.name,size:t.size,totalChunks:s,chunkSize:this.transferConfig.chunkSize};try{r.send(JSON.stringify(f)),console.log("üì¶ Â∑≤ÂèëÈÄÅÊñá‰ª∂ÂÖÉÊï∞ÊçÆ:",f)}catch(b){console.error("‚ùå Êó†Ê≥ïÂèëÈÄÅÊñá‰ª∂ÂÖÉÊï∞ÊçÆÔºö",b);return}const g=b=>new Promise((h,v)=>{if(this.aborted)return v(new Error("ËØªÂèñ‰∏≠Ê≠¢"));const F=b*this.transferConfig.chunkSize,P=t.slice(F,F+this.transferConfig.chunkSize),T=new FileReader;T.onload=()=>{if(this.aborted)return v(new Error("ËØªÂèñ‰∏≠Ê≠¢"));T.result instanceof ArrayBuffer?h(T.result):v(new Error("ËØªÂèñÁªìÊûú‰∏çÊòØ ArrayBuffer"))},T.onerror=k=>v(k),T.readAsArrayBuffer(P)}),x=async b=>{if(!this.aborted)try{const h=await g(b);if(this.aborted)return;const v=8,F=new ArrayBuffer(v+h.byteLength),P=new DataView(F);P.setUint32(0,b),P.setUint32(4,h.byteLength),new Uint8Array(F,v).set(new Uint8Array(h));const T=()=>{if(!this.aborted)if(r.bufferedAmount<this.transferConfig.bufferThreshold){console.log(r.bufferedAmount),r.send(F),c++;const k=Math.min(c/s*100,100);this.setFileTransferProgress(k),k>=100&&(setTimeout(()=>this.setFileTransferProgress(null),1500),this.setDownloadPageState(!1)),this.isSendingFile=k<100&&k>0}else{const k=setTimeout(T,100);this.timeoutHandles.add(k)}};T()}catch(h){this.aborted||console.error(`ÂàáÁâá ${b} ÂèëÈÄÅÂ§±Ë¥•:`,h)}};await(async()=>{for(;d<s&&!this.aborted;){l.length>=i&&await Promise.race(l);const b=d++,h=x(b);l.push(h),h.finally(()=>{const v=l.indexOf(h);v>-1&&l.splice(v,1)})}})(),await Promise.allSettled(l),this.aborted?console.warn("üö´ Êñá‰ª∂ÂèëÈÄÅË¢´‰∏≠Ê≠¢"):console.log("‚úÖ Êñá‰ª∂ÂèëÈÄÅÂÆåÊàê")}generateUUID(){return Math.random().toString(36).substring(2,8)}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}getConnectedUserIds(){return Array.from(this.userList.entries()).filter(([e,t])=>t.status==="connected").map(([e])=>e)}async waitForUnlock(e){const s=Date.now();for(;e;){if(Date.now()-s>1e4){console.warn("‚ö†Ô∏è Á≠âÂæÖ cleaningLock Ëß£ÈîÅË∂ÖÊó∂ÔºåÊîæÂºÉ discover");return}await new Promise(i=>setTimeout(i,200))}}}const C=m.getInstance();async function ht(){if(navigator.clipboard&&typeof navigator.clipboard.readText=="function")try{return await navigator.clipboard.readText()||""}catch(o){console.error("Failed to read clipboard contents via clipboard API: ",o),I("ËØªÂèñÂâ™Ë¥¥ÊùøÂÜÖÂÆπÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊùÉÈôêÊàñÊâãÂä®Á≤òË¥¥„ÄÇ",3e3,{kind:"error"})}return I("ÂΩìÂâçÊµèËßàÂô®‰∏çÊîØÊåÅËØªÂèñÂâ™Ë¥¥Êùø",3e3,{kind:"warning"}),""}async function gt(o){if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")try{if(await navigator.clipboard.writeText(o),typeof navigator.clipboard.readText=="function")try{const e=await navigator.clipboard.readText();if(e===o)return!0;console.warn("Clipboard text mismatch. Written vs Read:",o,e)}catch(e){console.warn("Could not verify clipboard content:",e)}else return!0}catch(e){console.error("Failed to write clipboard via Clipboard API:",e)}try{const e=document.createElement("textarea");e.value=o,e.style.position="fixed",e.style.top="-1000px",document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");if(document.body.removeChild(e),t)return!0;console.warn("execCommand copy returned false.")}catch(e){console.error("Failed to write clipboard via execCommand:",e)}return I("Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂ÊñáÊú¨„ÄÇ",3e3,{kind:"warning"}),!1}const pt=()=>{const[o,e]=u.useState(!1),t=()=>e(!0),r=()=>e(!1);return n.jsxs(n.Fragment,{children:[n.jsxs(p,{component:"footer",sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderTop:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0",mb:"20px",mt:"auto"},children:[n.jsx(A,{variant:"body2",color:"text.secondary",children:"¬© 2025 LetShare Copyright Author Onion"}),n.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[n.jsx(ee,{"aria-label":"GitHub",component:"a",href:"https://github.com/LiWeny16/LetShare",target:"_blank",rel:"noopener noreferrer",children:n.jsx(Me,{})}),n.jsx(ee,{"aria-label":"QR Code",onClick:t,children:n.jsx(Le,{})})]})]}),n.jsxs(K,{open:o,onClose:r,children:[n.jsx(de,{children:"ÂàÜ‰∫´¬∑‰∏ÄËß¶Âç≥Âèë"}),n.jsx(Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4},children:n.jsx(ge,{value:"https://bit.ly/4j0NA74",size:180,ecLevel:"H",quietZone:10})})]})]})},ft=({onEditDone:o})=>{const[e,t]=u.useState(!1),[r,s]=u.useState(""),[i,c]=u.useState(!1),d=u.useRef("");u.useEffect(()=>{const x=C.getUserId();x&&(s(x),d.current=x)},[]);const l=/^[\u4e00-\u9fa5a-zA-Z0-9]*$/,f=x=>{const D=x.target.value;s(D),c(!l.test(D))},g=()=>{const x=r.trim();if(!l.test(x)||!x){s(d.current),c(!0),t(!1);return}C.setUserId(x),d.current=x,c(!1),t(!1),o&&o(x)};return n.jsx(n.Fragment,{children:e?n.jsx(V,{value:r,onChange:f,onBlur:g,onKeyDown:x=>{x.key==="Enter"&&g()},autoFocus:!0,variant:"standard",error:i,helperText:i?"Âè™ÂÖÅËÆ∏ËæìÂÖ•Â≠óÊØç„ÄÅÊï∞Â≠óÂíåÊ±âÂ≠ó":" ",inputProps:{style:{textAlign:"center"}},sx:{mt:2,display:"block",mx:"auto"}}):n.jsxs(A,{variant:"body2",color:"textSecondary",align:"center",sx:{mt:2,cursor:"pointer"},onClick:()=>t(!0),children:["‰Ω†ÁöÑID: ",r]})})},mt=({open:o})=>{const[e,t]=u.useState(!1);return n.jsx(q,{in:o,timeout:600,unmountOnExit:!0,children:n.jsx(p,{sx:{width:"100vw",minHeight:"100vh",position:"fixed",top:0,left:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)",color:"white",textAlign:"center",p:2,boxSizing:"border-box",zIndex:9999},children:n.jsxs(p,{sx:{mb:"200px",display:"flex",flexDirection:"column",alignItems:"center"},children:[n.jsx(p,{sx:{width:{xs:120,sm:160,md:200},height:{xs:120,sm:160,md:200},mb:3,display:"flex",justifyContent:"center",alignItems:"center"},children:n.jsx(q,{in:e,timeout:600,children:n.jsx(p,{component:"img",src:"/icons/512x512.png",alt:"Logo",onLoad:()=>t(!0),sx:{width:"100%",height:"100%",objectFit:"contain"}})})}),n.jsx(A,{variant:"h6",sx:{fontWeight:300},children:"Connect To The World"}),n.jsx(A,{variant:"subtitle1",sx:{opacity:.85},children:"ËΩªËß¶ÔºåÂºÄÂêØÈÄöÂæÄ‰∏ñÁïåÁöÑÂ§ßÈó®"}),n.jsx(p,{mt:4,children:n.jsx(Y,{color:"inherit"})})]})})})};function xt({open:o,progress:e,setProgress:t,onClose:r,targetUserId:s}){const i=Ne(),[c,d]=N.useState(o),[l,f]=N.useReducer(S=>S+1,0);N.useEffect(()=>{o&&d(!0)},[o]),N.useEffect(()=>{const S=setInterval(()=>{f()},300);return()=>clearInterval(S)},[]);const g=()=>{d(!1),r()},x=C.receivingFiles,D=C.receivedFiles,b=Array.from(x.entries()),h=Array.from(D.entries()),v=S=>{const w=C.dataChannels.get(S);w&&w.send(JSON.stringify({type:"abort"})),r(),I(`ÁªàÊ≠¢Êù•Ëá™ ${S.split(":")[0]} ÁöÑÊé•Êî∂`,2e3,{kind:"error"}),x.delete(S),f(),x.size===0&&e===null&&d(!1)},F=()=>{r(),I("ÁªàÊ≠¢ÂèëÈÄÅ",2e3,{kind:"error"}),C.abortFileTransferToUser?.(),t(0),x.size===0&&d(!1)},P=S=>{const w=S.split(".").pop()?.toLowerCase();return w?["png","jpg","jpeg","gif","bmp","webp","svg"].includes(w)?n.jsx(Ve,{fontSize:"medium"}):["mp4","mov","avi","mkv","webm"].includes(w)?n.jsx(Be,{fontSize:"medium"}):["zip","rar","7z","tar","gz","xz","bz2"].includes(w)?n.jsx(Oe,{fontSize:"medium"}):w==="pdf"?n.jsx(We,{fontSize:"medium"}):["doc","docx"].includes(w)?n.jsx(He,{fontSize:"medium"}):["xls","xlsx","csv"].includes(w)?n.jsx(Qe,{fontSize:"medium"}):["ppt","pptx"].includes(w)?n.jsx(Ke,{fontSize:"medium"}):["txt","md","rtf"].includes(w)?n.jsx(Ze,{fontSize:"medium"}):["js","ts","jsx","tsx","html","css","scss","py","java","c","cpp","cs","json","xml","yml","yaml","sh","bat","go","rs"].includes(w)?n.jsx(qe,{fontSize:"medium"}):n.jsx(ne,{fontSize:"medium"}):n.jsx(ne,{fontSize:"medium"})},T=S=>{const w=new Blob([S]),U=document.createElement("a");U.href=URL.createObjectURL(w),U.download=S.name||"shared_file",document.body.appendChild(U),U.click(),document.body.removeChild(U)},k=e!==null||b.length>0||h.length>0;return!c&&!o?null:n.jsxs(n.Fragment,{children:[n.jsx(ue,{open:o,onClick:r,sx:{zIndex:i.zIndex.modal,backgroundColor:"rgba(0, 0, 0, 0.4)"}}),n.jsx(Je,{style:{userSelect:"none"},in:o,direction:"down",mountOnEnter:!0,unmountOnExit:!0,onExited:g,children:n.jsx(p,{onClick:S=>{S.target===S.currentTarget&&d(!1)},sx:{position:"fixed",top:0,left:0,width:"100%",display:"flex",justifyContent:"center",zIndex:i.zIndex.modal},children:n.jsxs(p,{className:"uniformed-scroller",sx:{width:{xs:"88%",sm:"80%",md:"60%",lg:"50%"},maxHeight:400,overflowY:"auto",backgroundColor:i.palette.background.paper,boxShadow:3,px:2,py:2,borderBottomLeftRadius:19,borderBottomRightRadius:19,display:"flex",flexDirection:"column",gap:2},children:[k&&n.jsxs(n.Fragment,{children:[e!==null&&n.jsxs(p,{sx:{display:"flex",flexDirection:"column",gap:1},children:[n.jsxs(A,{variant:"body2",color:"text.secondary",children:["üì§ Ê≠£Âú®ÂèëÈÄÅÊñá‰ª∂Áªô ",n.jsx("strong",{children:s?.split(":")[0]??"Êú™Áü•Áî®Êà∑"})]}),n.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsxs(p,{sx:{flex:1},children:[n.jsxs(A,{variant:"caption",color:"text.secondary",children:[e.toFixed(1),"%"]}),n.jsx(te,{variant:"determinate",value:e,sx:{height:8,borderRadius:5,mt:.5}})]}),n.jsx(E,{variant:"contained",color:"error",size:"small",onClick:F,sx:{whiteSpace:"nowrap",minWidth:64,...J},children:"ÂèñÊ∂à"})]})]},"sending"),b.map(([S,w])=>{const U=w.size?w.receivedSize/w.size*100:0;return n.jsxs(p,{sx:{display:"flex",flexDirection:"column",gap:1},children:[n.jsxs(A,{variant:"body2",color:"text.secondary",children:["üì• Ê≠£Âú®Êé•Êî∂Êù•Ëá™ ",n.jsx("strong",{children:S.split(":")[0]})," ÁöÑÊñá‰ª∂Ôºö",w.name]}),n.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsxs(p,{sx:{flex:1},children:[n.jsxs(A,{variant:"caption",color:"text.secondary",children:[U.toFixed(1),"%Ôºà",w.receivedSize," / ",w.size," Â≠óËäÇÔºâ"]}),n.jsx(te,{variant:"determinate",value:U,sx:{height:8,borderRadius:5,mt:.5}})]}),n.jsx(E,{variant:"contained",color:"error",size:"small",onClick:()=>v(S),sx:{whiteSpace:"nowrap",minWidth:64,...J},children:"ÂèñÊ∂à"})]})]},S)}),h.length>0&&n.jsxs(p,{children:[n.jsx(A,{variant:"subtitle2",sx:{mt:2,mb:1},children:"üìÅ Â∑≤Êé•Êî∂ÁöÑÊñá‰ª∂"}),n.jsx(p,{sx:{display:"flex",flexDirection:"column",gap:1},children:h.map(([S,w])=>n.jsxs(p,{onClick:()=>T(w),sx:{display:"flex",alignItems:"center",gap:1.5,px:2,py:1.5,borderRadius:2,boxShadow:1,backgroundColor:"#f9f9f9",cursor:"pointer",transition:"0.2s","&:hover":{boxShadow:3,backgroundColor:"#f0f0f0"}},children:[P(w.name),n.jsx(A,{variant:"body2",noWrap:!0,children:w.name})]},S))})]})]}),c&&!k&&n.jsx(p,{sx:{textAlign:"center",color:"gray",py:2},children:"Ê≤°ÊúâËøõË°å‰∏≠ÁöÑ‰ªªÂä°"})]})})})]})}const le="wss://md-server-md-server-bndnqhexdf.cn-hangzhou.fcapp.run",yt={transition:"background-color 0.4s ease, box-shadow 0.4s ease",position:"relative",padding:"10px",borderRadius:"8px",display:"flex",flexDirection:"column",mt:"10px",mb:"5px",backgroundColor:"white",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",overflow:"hidden",cursor:"pointer"},W={"& .MuiBadge-badge":{top:4,right:4}},J={borderRadius:"5px",borderColor:"#e0e0e0"};function wt(){const[o,e]=u.useState(null),[t,r]=u.useState(!1),[s,i]=u.useState([]),[c,d]=u.useState(!1),[l,f]=u.useState("clip"),[g,x]=u.useState(null),[D,b]=u.useState(null),[h,v]=u.useState(!1),[F,P]=u.useState(""),[T,k]=u.useState(null),[S,w]=u.useState(!0),[U,fe]=u.useState(!0),[me,B]=u.useState(!1),[G,Q]=N.useState(!1),[xe,ye]=N.useState(""),we=u.useRef(null),X=u.useRef(null),Se=a=>{switch(a){case"apple":return n.jsx(rt,{sx:{transition:"color 0.3s ease"}});case"android":return n.jsx(st,{sx:{transition:"color 0.3s ease"}});case"desktop":return n.jsx(re,{sx:{transition:"color 0.3s ease"}});default:return n.jsx(re,{sx:{transition:"color 0.3s ease"}})}},be=()=>{P(""),v(!0)},Ce=a=>{const y=Array.from(a.entries()).map(([j,L])=>{const[z,M]=j.split(":");return{uniqId:M?`${z}:${M}`:j,name:z||j,status:L.status,userType:L.userType}});i(y)},ve=async()=>{d(!0);try{C.isConnected()?C.broadcastSignal({type:"discover",userType:H()}):await C.connect(le).catch(console.error),await he.sleep(1e3)}catch(a){console.error("Search error:",a)}finally{d(!1)}},$=a=>{const y=a.target.files?.[0]||null;y&&(x(y),f("file"))},je=async a=>{const y=a.target.files;if(!(!y||y.length===0))try{const j=new ot;Array.from(y).forEach(M=>{j.file(M.name,M)});const L=await j.generateAsync({type:"blob"}),z=new File([L],`LetShare_${Date.now()}.zip`,{type:"application/zip"});x(z),f("zip")}catch(j){console.error("ÂéãÁº©Â§±Ë¥•:",j),I("Êñá‰ª∂ÂéãÁº©Â§±Ë¥•ÔºåËØ∑ÈáçËØïÔºÅ",2e3,{kind:"error"})}},Ie=async(a,y)=>{try{if(!C.isConnectedToUser(y)){I("Ê≠£Âú®ËøûÊé•ÁõÆÊ†áÁî®Êà∑ÔºåËØ∑Á≠âÂæÖËøûÊé•Âª∫Á´ã",2e3,{kind:"warning"}),C.connectToUser(y);return}if((l==="file"||l==="zip")&&g){if(C.isSendingFile){I("Êúâ‰ªªÂä°Ê≠£Âú®ËøõË°å‰∏≠ÔºÅ",2e3,{kind:"info"}),B(!0);return}B(!0),await C.sendFileToUser(y,g)}else if(l==="text"&&D)await C.sendMessageToUser(y,D);else if(l==="clip"){let j=await ht();j!=""?await C.sendMessageToUser(y,j??"ËØªÂèñÂâ™ÂàáÊùøÂ§±Ë¥•"):I("Ââ™ÂàáÊùø‰∏∫Á©∫, ÊàñÊµèËßàÂô®‰∏çÊîØÊåÅ",2e3,{kind:"info"})}else I("Êú™ÈÄâÊã©ÂèëÈÄÅÂÜÖÂÆπ",2e3,{kind:"info"})}catch(j){console.error("ÂèëÈÄÅÂ§±Ë¥•Ôºö",j)}};u.useEffect(()=>(C.init(ye,a=>{e(a),r(!0)},B,Ce,k),setTimeout(()=>{fe(!1)},1e3),C.connect(le).catch(console.error),()=>{C.disconnect(e)}),[U]),u.useEffect(()=>{const a=async y=>{if(h||t)return;const j=y.clipboardData;if(!j)return;const L=j.items;for(const M of L)if(M.kind==="file"){const _=M.getAsFile();if(_){x(_),f("file");return}}const z=j.getData("text/plain");z&&z.trim().length>0&&(b(z),f("text"))};return window.addEventListener("paste",a),w(!1),()=>{window.removeEventListener("paste",a)}},[h,t]);const ke=()=>{try{o&&(gt(o),I("ÊàêÂäüÂÜôÂÖ•Ââ™Ë¥¥Êùø",2e3,{kind:"success"}))}catch(a){console.error("Â§ÑÁêÜÊé•ÂèóÂ§±Ë¥•",a)}finally{r(!1),setTimeout(()=>{e(null)},500)}},De=a=>{a.preventDefault(),a.stopPropagation()},Ae=a=>{a.preventDefault(),a.stopPropagation(),Q(!0)},Fe=a=>{a.preventDefault(),a.stopPropagation();const y=X.current?.getBoundingClientRect();y&&(a.clientX<y.left||a.clientX>y.right||a.clientY<y.top||a.clientY>y.bottom)&&Q(!1)},Te=a=>{a.preventDefault(),a.stopPropagation(),Q(!1);const y=a.dataTransfer.files;y.length>0&&$({target:{files:y}})};return n.jsxs(n.Fragment,{children:[!U&&n.jsxs(p,{ref:X,onDragEnter:Ae,onDragLeave:Fe,onDragOver:De,onDrop:Te,sx:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"75%",sm:"80%",md:"60%"},maxWidth:"900px",height:"70vh",p:3,m:"auto",boxShadow:8,borderRadius:2,backgroundColor:"background.paper",zIndex:a=>a.zIndex.modal,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[G&&n.jsx(q,{in:G,timeout:400,unmountOnExit:!0,children:n.jsx(p,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1e3,backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:n.jsx(A,{variant:"h6",color:"white",children:"ÊùæÊâã‰∏ä‰º†Êñá‰ª∂"})})}),n.jsx(pt,{}),n.jsxs(p,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[n.jsx(O,{color:"primary",badgeContent:l==="file"?1:0,overlap:"circular",sx:W,children:n.jsx(E,{variant:"outlined",sx:J,startIcon:n.jsx(Ye,{}),onClick:()=>{const a=document.getElementById("file-input");a&&(a.value="",a.click())},children:"Êñá‰ª∂"})}),n.jsx("input",{id:"file-input",type:"file",hidden:!0,onChange:$}),n.jsx(O,{color:"primary",badgeContent:l==="zip"?1:0,overlap:"circular",sx:W,children:n.jsx(E,{variant:"outlined",sx:J,startIcon:n.jsx(Re,{}),onClick:()=>{const a=document.getElementById("folder-input");a&&(a.value="",a.click())},children:"ÂéãÁº©ÂåÖ"})}),n.jsx("input",{id:"folder-input",type:"file",hidden:!0,multiple:!0,onChange:je}),n.jsx(O,{color:"primary",badgeContent:l==="text"?1:0,overlap:"circular",sx:W,children:n.jsx(E,{onClick:be,variant:"outlined",startIcon:n.jsx(Ge,{}),sx:J,children:"ÊñáÊú¨"})}),n.jsx(O,{color:"primary",badgeContent:l==="clip"?1:0,overlap:"circular",sx:W,children:n.jsx(E,{onClick:()=>f("clip"),variant:"outlined",startIcon:n.jsx(Xe,{}),sx:J,children:"Ââ™Ë¥¥Êùø"})})]}),n.jsx(p,{sx:{mt:3},children:n.jsx(E,{ref:we,onClick:ve,variant:"contained",endIcon:c?n.jsx(Y,{size:20,color:"inherit"}):n.jsx($e,{}),disabled:c,children:"ÊêúÁ¥¢ÂêåWIFI‰∏ãÁî®Êà∑"})}),n.jsx(_e,{sx:{my:2}}),n.jsx(p,{sx:{flexGrow:1,overflowY:"auto"},children:[...s].sort((a,y)=>a.status==="connected"&&y.status==="connected"?C.compareUniqIdPriority(a.uniqId,y.uniqId)?-1:1:0).map(a=>n.jsx(p,{sx:{...yt,width:"93%",backgroundColor:a.status==="waiting"?"rgba(0, 0, 0, 0.08)":"background.paper",opacity:a.status==="waiting"?.7:1,transition:"all 0.3s ease-in-out","&:hover":{boxShadow:a.status==="connected"?2:1,bgcolor:a.status==="waiting"?"rgba(0, 0, 0, 0.12)":"background.default"}},onClick:y=>Ie(y,a.uniqId),children:n.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1,transition:"opacity 0.3s ease",opacity:a.status==="waiting"?.8:1},children:[Se(a.userType),n.jsx(A,{sx:{color:a.status==="connected"?"text.primary":"text.secondary",transition:"color 0.3s ease"},children:a.name})]})},a.uniqId))}),n.jsx(et,{color:"primary",onClick:()=>{B(!0)},sx:{position:"absolute",bottom:65,right:35,zIndex:a=>a.zIndex.modal+1},children:n.jsx(tt,{})}),n.jsx(ft,{})]}),n.jsxs(K,{open:t,onClose:()=>{r(!1),setTimeout(()=>{e(null)},300)},children:[n.jsx(de,{children:"‚ú® Êñ∞ÂàÜ‰∫´"}),n.jsxs(Z,{sx:{width:{sx:200,sm:200,md:400,lg:400}},children:[n.jsx(nt,{children:"ÊÇ®ÊúâÊù•Ëá™Â§ñÈÉ®ÁöÑÊ∂àÊÅØÔºåÊòØÂê¶Êé•ÂèóÔºü"}),o&&n.jsx(V,{value:o??"",multiline:!0,fullWidth:!0,InputProps:{readOnly:!0},variant:"outlined",sx:{border:"none",maxHeight:300,overflowY:"auto",backgroundColor:"#f5f5f5",borderRadius:1,mt:1,fontSize:{xs:"14px",sm:"15px"},"& .MuiInputBase-input":{whiteSpace:"pre-wrap"}}})]}),n.jsxs(se,{children:[n.jsx(E,{onClick:()=>{r(!1),e(null)},color:"secondary",children:"ÊãíÁªù"}),n.jsx(E,{onClick:ke,color:"primary",autoFocus:!0,children:"Êé•Âèó"})]})]}),n.jsxs(K,{open:h,onClose:()=>v(!1),fullWidth:!0,maxWidth:"sm",PaperProps:{sx:{borderRadius:2,px:{xs:1,sm:4},py:2,mx:{xs:1,sm:"auto"}}},children:[n.jsxs(se,{sx:{px:{xs:2,sm:3},pb:{xs:1,sm:2},justifyContent:"flex-end"},children:[n.jsx(A,{variant:"h6",sx:{flexGrow:1},children:"ËæìÂÖ•ÊñáÊú¨"}),n.jsx(E,{onClick:()=>v(!1),color:"secondary",children:"ÂèñÊ∂à"}),n.jsx(E,{onClick:()=>{F?(b(F),f("text")):I("Á©∫Âï¶",1e3,{kind:"info"}),v(!1)},color:"primary",variant:"contained",children:"Á°ÆËÆ§"})]}),n.jsx(Z,{children:n.jsx(V,{autoFocus:!0,value:F,onChange:a=>P(a.target.value),multiline:!0,rows:6,fullWidth:!0,variant:"outlined",placeholder:"ËØ∑ËæìÂÖ•Ë¶ÅÂèëÈÄÅÁöÑÊñáÊú¨...",sx:{mt:1,fontSize:{xs:"14px",sm:"16px"}}})})]}),n.jsx(xt,{targetUserId:xe,onClose:()=>{B(!1)},open:me,progress:T,setProgress:k}),n.jsx(ue,{sx:{color:"#fff",zIndex:a=>a.zIndex.drawer+9999},open:S,children:n.jsx(Y,{color:"inherit"})}),n.jsx(mt,{open:U}),n.jsx(dt,{})]})}const St="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANMAAACECAYAAAAKjB6WAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjdFMjg1MUU1MEJGMTFFN0IxNEZDN0U5MzZCREMyQjMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjdFMjg1MUY1MEJGMTFFN0IxNEZDN0U5MzZCREMyQjMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2N0UyODUxQzUwQkYxMUU3QjE0RkM3RTkzNkJEQzJCMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2N0UyODUxRDUwQkYxMUU3QjE0RkM3RTkzNkJEQzJCMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrGIRRAAABbASURBVHja7F1/cFzF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";function R(o,e,t){return e<String(o).length?o.toString():Array(e-String(o).length+1).join("0")+o}function bt(o){const e=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];let t=65535,r,s;for(s=0;s<o.length;s++){const i=o.charCodeAt(s);if(i>255)throw new RangeError;r=(i^t>>8)&255,t=e[r]^t<<8}return R(((t^0)&65535).toString(16).toUpperCase(),4)}function Ct(o){let t=[{id:"00",value:"01"},{id:"01",value:"11"},{id:"26",value:[{id:"00",value:"SG.PAYNOW"},{id:"01",value:"0"},{id:"02",value:o.uen},{id:"03",value:o.editable.toString()},{id:"04",value:o.expiry}]},{id:"52",value:"0000"},{id:"53",value:"702"},{id:"54",value:o.amount.toString()},{id:"58",value:"SG"},{id:"59",value:o.name},{id:"60",value:"Singapore"},{id:"62",value:[{id:"01",value:"Blank is fine..."}]}].reduce((r,s)=>(Array.isArray(s.value)&&(s.value=s.value.reduce((i,c)=>(i+=c.id+R(c.value.length.toString(),2)+c.value,i),"")),r+=s.id+R(s.value.length.toString(),2)+s.value,r),"");return t+="6304"+bt(t+"6304"),t}const vt=()=>{const[o,e]=u.useState(localStorage.getItem("countryCode")||"+65"),[t,r]=u.useState(localStorage.getItem("phoneNumber")||""),[s,i]=u.useState(localStorage.getItem("payNowName")||"");u.useEffect(()=>{localStorage.setItem("countryCode",o)},[o]),u.useEffect(()=>{localStorage.setItem("phoneNumber",t)},[t]),u.useEffect(()=>{localStorage.setItem("payNowName",s)},[s]);const c=h=>{e(h.target.value)},d=h=>{r(h.target.value)},l=h=>{i(h.target.value)},g={uen:`${o}${t}`,name:s||"Payee",editable:1,expiry:"20990106",amount:0,refNumber:""},x=Ct(g),[D,b]=u.useState(!1);return u.useEffect(()=>{const h=()=>{window.innerHeight<document.documentElement.clientHeight?b(!0):b(!1)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),n.jsxs(it,{maxWidth:"xs",sx:{height:D?"calc(100vh - 50px)":"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingBottom:D?"50px":"0"},children:[n.jsxs(p,{sx:{width:"100%",mb:4},children:[n.jsxs(V,{select:!0,label:"ÂõΩÂÆ∂‰ª£Á†Å",value:o,onChange:c,variant:"outlined",sx:{width:"30%",mr:1},children:[n.jsx(ie,{value:"+65",children:"+65 Êñ∞Âä†Âù°"}),n.jsx(ie,{value:"+86",children:"+86 ‰∏≠ÂõΩ"})]}),n.jsx(V,{label:"ÊâãÊú∫Âè∑",variant:"outlined",value:t,onChange:d,sx:{width:"65%"}})]}),n.jsx(p,{sx:{width:"100%",mb:4},children:n.jsx(V,{label:"PayNow ÂêçÂ≠ó",variant:"outlined",fullWidth:!0,value:s,onChange:l})}),n.jsx(p,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:n.jsxs(p,{sx:{width:"80%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.1)",padding:"16px",borderRadius:"8px",backgroundColor:"#fff"},children:[n.jsxs(p,{sx:{height:"8svh"},children:[n.jsx(p,{sx:{height:"4.4svh"},children:n.jsx("p",{style:{textAlign:"center",fontSize:"25px",margin:"0"},children:n.jsx("b",{children:s})})}),n.jsx(p,{sx:{height:"3svh"},children:n.jsx("p",{style:{textAlign:"center",color:"#645f60",fontSize:"20px",margin:"0"},children:o+" "+t})})]}),n.jsx(ge,{style:{marginBottom:"10px"},value:x,size:250,fgColor:"#771976",logoImage:St,logoHeight:60,logoWidth:90,quietZone:10,logoOpacity:1,removeQrCodeBehindLogo:!0,eyeRadius:[{outer:0,inner:0},{outer:0,inner:0},{outer:0,inner:0}]}),n.jsx(E,{variant:"contained",color:"secondary",sx:{backgroundColor:"#771976"},children:"SCAN TO PAY"})]})})]})};function jt(){return n.jsx(ct,{children:n.jsxs(lt,{children:[n.jsx(ce,{path:"/",element:n.jsx(wt,{})}),n.jsx(ce,{path:"/paynow",element:n.jsx(vt,{})})]})})}Ee.createRoot(document.getElementById("root")).render(n.jsx(jt,{}));
